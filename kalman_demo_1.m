clc; clear all; close all;
z = [1.20618 1.24464 1.29007 1.50596 1.47972 1.48712 1.66872 1.77237 1.72311 1.8606 1.84165 2.06244 2.04673 2.08947 1.82993 1.97517 2.00681 2.13301 2.07014 1.86737 1.75763 1.7662 1.66229 1.7039 1.47781 1.49102 1.53732 1.24243 1.16047 1.213 0.901697 0.833545 0.854712 0.714357 0.658508 0.481581 0.34378 0.259967 0.357403 0.356273 0.154732 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0.573639 0.572028 0.872024 0.913085 0.939502 1.11024 1.17368 1.3543 1.42638 1.4618 1.64935 1.33623 1.45681 1.63213 1.78152 1.88781 2.19585 2.03357 2.15001 1.95298 1.79206 2.04615 2.1187 2.04612 1.92553 1.78471 1.99999 1.78897 1.72931 1.60474 1.37084 1.35985 1.41472 1.2242 1.19202 1.04586 0.991129 0.9231 0.924906 0.677557 0.662545 0.436017 0.377127 0.224261 0.180972 0.0680133 0.132808 0.000357385 0.0430378 -0.222766 0.0894053 0.198622 -0.144952 -0.0632509 -0.0461875 -0.052352 0.15003 0.148308 0.183749 0.277071 0.185328 0.462494 0.562266 0.681969 0.776982 0.857774 0.890851 0.73489 0.887911 1.09432 1.44974 1.30817 1.55481 1.6447 1.77877 1.84394 1.65091 1.78341 1.75484 1.83855 1.94642 1.98262 2.05306 2.03522 1.94176 1.86562 1.89721 2.14745 1.81507 1.94177 1.93347 1.67853 1.76777 1.48393 1.40071 1.32913 1.29672 1.33206 1.00884 0.910073 0.851696 0.644432 0.739921 0.702779 0.644887 0.430915 0.457497 0.107344 0.255146 0.207541 0.0526641 0.00164107 -0.0133137 -0.0471202 -0.00939537 0.0916296 -0.0455939 0.014675 0.0432478 0.00205207 0.106778 0.227056 0.30219 0.31438 0.356864 0.491636 0.592912 0.496941 0.721209 0.762678 ; ...
     2.02767 1.91886 1.99043 2.26902 1.88455 2.07635 1.988 1.93169 1.90046 1.86947 1.85699 1.89239 1.83037 1.76239 1.9589 1.73431 1.77393 1.8851 1.83647 1.83473 1.71994 1.7356 1.47432 1.39254 1.79751 1.45451 1.3628 1.52553 1.41182 1.33355 1.28871 1.23604 1.2894 1.36249 1.02122 1.06993 1.08093 0.85292 1.13709 1.03468 1.17675 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1.30566 1.27962 1.15767 1.19033 1.39948 1.27579 1.28269 1.34239 1.42468 1.58681 1.46847 1.42226 1.85906 1.45482 1.60068 1.72723 1.94059 1.61385 1.82732 1.92725 2.08667 1.88303 1.75732 1.79705 1.98881 1.84531 1.90092 1.92526 2.065 1.96614 1.9705 2.0672 2.08903 2.02114 1.91571 1.87415 2.03679 2.09125 1.95025 2.13339 2.02942 1.89922 1.92074 2.07577 2.0949 1.98109 2.08847 2.02803 1.92254 1.7151 1.87958 1.81034 1.90438 1.88068 1.74582 1.6862 1.65878 1.57685 1.72946 1.45891 1.48013 1.62845 1.52726 1.59117 1.3932 1.35655 1.24392 1.2524 1.36387 1.17523 1.15123 1.31712 1.14834 1.13328 1.15851 1.12475 1.01255 0.915395 0.794027 0.92217 0.828685 0.758502 0.726613 0.623655 0.741772 0.660811 0.581466 0.503519 0.617024 0.212688 0.306791 0.406115 0.337525 0.11552 0.41107 0.268515 0.257016 0.258102 0.175141 0.048635 0.186856 0.209151 0.193019 0.107638 0.165964 0.293547 0.0936868 0.118389 -0.120974 -0.0321008 0.0213176 0.0479941 0.0563032 -0.017155 -0.00102155 -0.075798 -0.121461 0.0648313 0.152291 0.0153247 0.154043 0.0097981 0.233724 -0.0900893 -0.0595559 0.135937 0.0500655 0.05495 0.280277 0.141659 ];
x = [1 1.00952 1.03654 1.08903 1.20347 1.31567 1.41586 1.54831 1.6816 1.7695 1.87201 1.94416 2.05401 2.13468 2.20589 2.19639 2.21579 2.23323 2.27149 2.28374 2.24092 2.17235 2.11 2.02783 1.9636 1.85316 1.75972 1.6902 1.56184 1.43327 1.33755 1.18528 1.04209 0.929087 0.80495 0.691662 0.55966 0.421072 0.290106 0.209256 0.148961 0.0588521 0.190468 0.31425 0.428792 0.533213 0.627069 0.710274 0.783021 0.845724 0.898957 0.943408 0.979837 1.00904 1.03183 1.04899 1.0613 1.06948 1.07419 1.07607 1.07566 1.07347 1.06991 1.06537 1.06018 1.05459 1.04884 1.04309 1.03749 1.03215 1.02714 1.02253 1.01833 1.01457 1.01124 1.00834 1.00585 1.00374 1.00199 1.00056 0.999416 0.998531 0.99787 0.997403 0.997098 0.996931 0.996875 0.996908 0.997011 0.997166 0.997359 0.997576 0.997808 0.998045 0.99828 0.998507 0.998724 0.998926 0.999112 0.999281 0.999432 0.999565 0.99968 0.999779 0.999862 0.999931 0.999988 1.00003 1.00007 1.00009 1.00011 1.00012 1.00013 1.00013 1.00013 1.00012 1.00011 1.00011 1.0001 1.00009 1.00008 0.89907 0.811028 0.806792 0.814799 0.829804 0.884793 0.948742 1.0475 1.14999 1.246 1.37143 1.40298 1.45475 1.53712 1.63977 1.74934 1.91208 2.00891 2.1134 2.14996 2.13576 2.17624 2.22209 2.23846 2.21802 2.1613 2.15826 2.10195 2.03569 1.94636 1.8121 1.69276 1.60347 1.4833 1.37456 1.24974 1.13336 1.02201 0.932258 0.802762 0.694066 0.553979 0.426723 0.289013 0.168647 0.0473546 -0.0323533 -0.122435 -0.180256 -0.283239 -0.288933 -0.258162 -0.30397 -0.316764 -0.316514 -0.311069 -0.25242 -0.196631 -0.13572 -0.0576938 -0.00964163 0.0987135 0.216749 0.346681 0.479884 0.611347 0.72888 0.788561 0.870502 0.984393 1.16105 1.27387 1.42204 1.56338 1.70852 1.84005 1.89807 1.96904 2.01358 2.06208 2.12031 2.17045 2.22198 2.25416 2.25195 2.22448 2.20141 2.23496 2.1805 2.15853 2.13387 2.04908 1.99422 1.87813 1.75718 1.63607 1.52535 1.44082 1.29494 1.14951 1.01515 0.856135 0.748208 0.654165 0.567559 0.450552 0.364168 0.215474 0.130643 0.0556151 -0.0364202 -0.118814 -0.184288 -0.239642 -0.269545 -0.26272 -0.281057 -0.275387 -0.256954 -0.244741 -0.204186 -0.136025 -0.0555134 0.0196867 0.0963142 0.195081 0.30425 0.374695 0.486359 ; ...
     1 1.04745 1.15157 1.3332 1.61919 1.80544 2.01072 2.14296 2.21955 2.25956 2.27251 2.27048 2.26981 2.24633 2.20319 2.20798 2.15297 2.10993 2.09452 2.06611 2.0378 1.98365 1.93806 1.83571 1.72664 1.72753 1.64909 1.56068 1.52448 1.46906 1.40541 1.34285 1.27972 1.24153 1.22996 1.14326 1.08347 1.03863 0.950331 0.945668 0.922481 0.94065 0.918952 0.903866 0.894364 0.889498 0.888405 0.890312 0.894536 0.900481 0.907635 0.915563 0.923904 0.932365 0.94071 0.948755 0.956366 0.963446 0.969931 0.975787 0.981002 0.985582 0.989548 0.992933 0.995775 0.998119 1.00001 1.0015 1.00264 1.00347 1.00404 1.00439 1.00456 1.00457 1.00447 1.00428 1.00403 1.00373 1.0034 1.00305 1.0027 1.00236 1.00204 1.00173 1.00144 1.00118 1.00095 1.00074 1.00056 1.0004 1.00026 1.00015 1.00006 0.999986 0.999928 0.999884 0.999852 0.99983 0.999818 0.999812 0.999813 0.999818 0.999826 0.999837 0.99985 0.999864 0.999878 0.999892 0.999906 0.999919 0.999932 0.999943 0.999954 0.999963 0.999971 0.999979 0.999985 0.99999 0.999995 0.999998 1 1.07241 1.12908 1.14858 1.1719 1.24029 1.26881 1.2931 1.32612 1.37203 1.44792 1.48313 1.49956 1.61406 1.6146 1.64561 1.69891 1.79215 1.7919 1.83785 1.89747 1.98294 2.00463 1.98892 1.98021 2.01422 2.0064 2.00941 2.01486 2.05003 2.0547 2.05721 2.07995 2.10272 2.10423 2.07839 2.04415 2.05148 2.06979 2.05135 2.07769 2.0752 2.04126 2.0161 2.03062 2.04772 2.03541 2.04979 2.04777 2.02069 1.94779 1.92353 1.88693 1.87846 1.86682 1.82605 1.77781 1.73103 1.67297 1.66099 1.58916 1.53436 1.52497 1.49617 1.48938 1.43967 1.39066 1.32452 1.27242 1.25727 1.2033 1.15439 1.15507 1.11965 1.08888 1.07171 1.05235 1.0123 0.957746 0.884957 0.855703 0.812157 0.761631 0.714189 0.652727 0.631558 0.598435 0.555088 0.503124 0.489077 0.385404 0.321722 0.294704 0.259932 0.18187 0.188728 0.165878 0.147697 0.136342 0.110763 0.0622389 0.0564104 0.0603357 0.0632992 0.0486272 0.0523476 0.0883201 0.0744119 0.0697832 0.0106407 -0.0181721 -0.028566 -0.0291988 -0.0258139 -0.0385106 -0.044163 -0.0652597 -0.0929607 -0.0713644 -0.0302512 -0.0257731 0.011635 0.0104738 0.0625866 0.0311874 0.0106711 0.0390726 0.0435126 0.0483305 0.105667 ];
duration = 250;
timeline = 1:1:duration;
subplot(1,1,1)
plot3(timeline, z(2,:), z(1,:), '-k', ...
      timeline, x(2,:), x(1,:), '-r');
xlabel('t');
ylabel('x');
zlabel('y');
title('kalman');
legend('orig', 'est')
